<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>?var:course.short Week 3 In-Class Activity: R, These are your First Steps – STA 9750 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-d3cb4660bf9ab46fc552571f6bf3984b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">STA 9750 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>?var:course.short</strong> Week 3 In-Class Activity: <code>R</code>, These are your First Steps</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<pre class="{webr}"><code>#| echo: false
#| message: true
webr::install("httpuv", quiet=TRUE)
webr::install("gradethis", quiet=TRUE)
webr::install("tidyverse", quiet=TRUE)
webr::install("nycflights13", quiet=TRUE)

suppressPackageStartupMessages(library(tidyverse))

if(require("gradethis", quietly = TRUE)){
    message("Auto-grader initialized successfully. You can now begin exercises.")
}</code></pre>
</div>
<div class="cell" data-edit="false">
<pre class="{webr}"><code>#| edit: false
#| output: false
webr::install("gradethis", quiet = TRUE)
library(gradethis)
options(webr.exercise.checker = function(
  label, user_code, solution_code, check_code, envir_result, evaluate_result,
  envir_prep, last_value, engine, stage, ...
) {
  if (is.null(check_code)) {
    # No grading code, so just skip grading
    invisible(NULL)
  } else if (is.null(label)) {
    list(
      correct = FALSE,
      type = "warning",
      message = "All exercises must have a label."
    )
  } else if (is.null(solution_code)) {
    list(
      correct = FALSE,
      type = "warning",
      message = htmltools::tags$div(
        htmltools::tags$p("A problem occurred grading this exercise."),
        htmltools::tags$p(
          "No solution code was found. Note that grading exercises using the ",
          htmltools::tags$code("gradethis"),
          "package requires a model solution to be included in the document."
        )
      )
    )
  } else {
    gradethis::gradethis_exercise_checker(
      label = label, solution_code = solution_code, user_code = user_code,
      check_code = check_code, envir_result = envir_result,
      evaluate_result = evaluate_result, envir_prep = envir_prep,
      last_value = last_value, stage = stage, engine = engine)
  }
})</code></pre>
</div>
<section id="slides" class="level1">
<h1><a href="../../STA9750/slides/slides03.html">Slides</a></h1>
</section>
<section id="welcome" class="level1">
<h1>Welcome!</h1>
<p>In this week’s in-class activities, we are going to dive a bit deeper into <code>R</code>’s basic data structure - the <em>vector</em></p>
<section id="vectors-in-r" class="level2">
<h2 class="anchored" data-anchor-id="vectors-in-r">Vectors in <code>R</code></h2>
<p><code>R</code> works with <em>3</em> core principal structures:</p>
<ul>
<li>Vectors: an ordered (one-dimensional) collection <em>of the same type</em>
<ul>
<li>Numeric (real number / double), Integer, Character, Logical (Boolean)</li>
<li>Scalars (single values) are just vectors of length 1</li>
</ul></li>
<li>Lists: an ordered collection of arbitrary objects (other vectors, other lists, <em>etc</em>)</li>
<li>Data Frames: ordered tabular database (think SQL tables)
<ul>
<li>Next week, we’ll discuss these in detail</li>
</ul></li>
</ul>
<p>This week, our primary focus is on <em>vectors</em>.</p>
</section>
<section id="review-of-r" class="level2">
<h2 class="anchored" data-anchor-id="review-of-r">Review of <code>R</code></h2>
<p>In this section, we will review some of the basic ‘built-in’ features of <code>R</code>.<br>
In the next section (<code>Packages</code>) we will discuss how to add to the “base-bones” functionality. When working with <code>R</code>, there are two interacting ‘subsystems’ in play:</p>
<ul>
<li>The <code>R</code> language and interpreter: this is the part of <code>R</code> that is similar to <code>python</code> or <code>C</code>/<code>C++</code>. You will write <code>R</code> code in the <code>R</code> language and the <code>R</code> interpreter will run that code. The fact that all of these elements are called <code>R</code> is a bit confusing, but once you get the hang of things, the distinctions will melt away.</li>
<li><code>R</code> packages: When working in <code>R</code>, you do not have to start from scratch every time. Other programmers make <code>sets</code> of code available to you in the form of <code>packages</code>. For our purposes, a package can contain two things:
<ul>
<li>Pre-written functions to help you achieve some goal</li>
<li>Data sets Most of the time, the primary purpose of a package is sharing functions and code: there are easier ways to share data with the world.</li>
</ul></li>
</ul>
<p>When you first downloaded <code>R</code>, you downloaded the interpreter and a set of base packages written by the “R Core Development Team”.</p>
<p>Run the following code to see what your <code>R</code> environment looks like:</p>
<div class="cell">
<pre class="{webr}"><code>sessionInfo()</code></pre>
</div>
<p>Compare the output of running this here-in the browser-with what you get by running <code>sessionInfo()</code> on your machine.</p>
<p>There is lots of useful information here, including</p>
<ul>
<li>the version of <code>R</code> being used</li>
<li>the operating system</li>
<li>the numerical linear algebra libraries (BLAS, LAPACK) used</li>
<li>system language and time zone information</li>
<li>loaded packages</li>
</ul>
<p>When asking for help, always include the output of the <code>sessionInfo()</code> command so that your helper can quickly know how your system is configured.</p>
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<p><code>R</code> code is distributed as <em>packages</em>, many of which come included with <code>R</code> by default. These are the <code>base</code> packages, and they are noted in your <code>sessionInfo()</code>. But we can do <em>many</em> more things with <code>R</code> using contributed (non-base) packages!</p>
<p>The most common platform for distributing <code>R</code> packages is <code>CRAN</code>, the Comprehensive R Archive Network, available at <a href="https://cran.r-project.org/">https://cran.r-project.org/</a>. You have likely already visited this site to download <code>R</code>. The <code>available.packages()</code> function in <code>R</code> lists all packages currently on <code>CRAN</code>. We can see that there are <em>many</em>:</p>
<p>The list of available packages is <em>long</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">available.packages</span>()[,<span class="st">"Package"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] "AalenJohansen" "aamatch"       "AATtools"      "ABACUS"       
 [5] "abasequence"   "abbreviate"    "abc"           "abc.data"     
 [9] "ABC.RAP"       "ABCanalysis"   "ABCDscores"    "abcel"        
[13] "abclass"       "ABCoptim"      "abcrlda"       "abctools"     
[17] "abd"           "abdiv"         "abe"           "aberrance"    
 [ reached 'max' / getOption("max.print") -- omitted 23032 entries ]</code></pre>
</div>
</div>
<p>As of the time of writing, CRAN contains approximately 23052 different freely available packages, while continuing to grow daily. A full list of CRAN packages can be found <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html">here</a>. In addition to all of these, there are even more packages hosted on sites like GitHub or on repositories that are specific to large organizations.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>If you want to use a contributed package, you need to do two things:</p>
<ol type="1">
<li>Download it from CRAN and install it onto your computer (one time)</li>
<li>Load it from your hard drive into <code>R</code> (every time you restart <code>R</code>)</li>
</ol>
<p>The first step - download and install - can be completed using the <code>install.packages()</code> function. For example, to install the <a href="https://nycflights13.tidyverse.org/"><code>nycflights13</code> package</a>, I would run:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"nycflights13"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will automatically download and install this package for me. <code>R</code> is helpful and also tries to automatically install all packages that a given package relies upon. Because of this, it is often sufficient to install the “last step” and trust <code>R</code> to handle the dependencies automatically. In this course, most of the packages we use can be automatically installed by installing the <code>tidyverse</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that there really isn’t much in the <code>tidyverse</code> package we want, but it’s a useful proxy for a much larger set of packages.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="There is no package called XXX">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
There is no package called XXX
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you encounter an error with the message ‘there is no package called <code>XXX</code>’, this almost always means you need to install package <code>XXX</code>. You can do so by running <code>install.packages("XXX")</code> in the <code>Console</code>.</p>
</div>
</div>
<p>Once a package is installed, we need to load it into <code>R</code> with the <code>library</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After doing this, we have access to the contents of the <code>nycflights13</code> package until we restart <code>R</code>.</p>
<div class="callout-danger">
<p>Note that the <code>install.packages</code> function requires you to quote its argument, but <code>library</code> does not. This is a weird historical quirk of <code>R</code> that you will trip up on many times before this course ends. To be safe, you can just quote the argument to <code>library()</code> as well</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>For example, <code>nycflights13</code> package provides a data set covering different US and Canadian airports. If we try to access that data set without loading <code>nycflights13</code>, we get an error message:</p>
<div class="cell">
<pre class="{webr}"><code>#| error: true
airports</code></pre>
</div>
<p>After we install and load <code>nycflights13</code>, we are good to go:</p>
<div class="cell">
<pre class="{webr}"><code>install.packages("nycflights13")
library(nycflights13)
head(airports, 10) # Print only the first 10 rows of the data set</code></pre>
</div>
<p>In general, if you get a error message of the form <code>Error: object 'X' not found</code>, you should:</p>
<ol type="1">
<li>Make sure you spelled <code>X</code> properly</li>
<li>If <code>X</code> comes from a package, make sure you <code>library()</code> that package.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="How do I know what a Package Contains?">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How do I know what a Package Contains?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As you first get started with the various packages we’ll use in this course, you might wonder how you should know what functions and data are in a given package. The easiest way to do so is to find the web documentation for that package. For the <code>nycflights13</code> package used above, a little web searching will lead you to <a href="https://nycflights13.tidyverse.org/" class="uri">https://nycflights13.tidyverse.org/</a>. On this site, we see a high-level description of what the <code>nycflights13</code> package includes. If you click “Reference” at the top of the page, you will be taken to a <a href="https://nycflights13.tidyverse.org/reference/index.html">page listing <em>everything</em></a> made available to you by that package. All of the packages we’ll use in this course have similarly designed web documentation. See the <a href="../../STA9750/resources.html">Resources Page</a> for direct links to some of the most important packages.</p>
<p>As a general rule, however, I don’t recommend trying to learn a package by learning <em>everything</em> in it. It’s much more productive to look up the functions you need ‘just-in-time’ for you to use them. This way, you will repeatedly look up the <em>most useful</em> functions and commit them to memory the most rapidly.</p>
</div>
</div>
</div>
<p>There’s no harm to <code>library()</code>-ing a package multiple times; if you <code>install.packages()</code> a package that you have already loaded, you may need to restart <code>R</code>.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>As mentioned last week, I <strong><em>strongly</em></strong> recommend <strong>never</strong> saving your workspace in <code>R</code> or <code>RStudio</code>. One of the things “saved” in a workspace is the list of loaded packages, so it becomes essentially impossible to re-install a package properly.</p>
</div>
</div>
</section>
<section id="variables-and-assignment" class="level3">
<h3 class="anchored" data-anchor-id="variables-and-assignment">Variables and Assignment</h3>
<p>Whenever you type a “word” of <code>R</code> code, it must be one of three things:</p>
<ul>
<li><p>A reserved word: this is a small set of <code>keywords</code> that <code>R</code> keeps for its own use. These have special rules for their use that we’ll learn as we go along. The main ones are: <code>if</code>, <code>else</code>, <code>for</code>, <code>in</code>, <code>while</code>, <code>function</code>, <code>repeat</code>, <code>break</code>, and <code>next</code>.</p>
<p>If you use one of these words and get a weird error message, it’s likely because you aren’t respecting the special rules for these words.</p>
<p>For the nitty gritty, see the <code>Reserved</code> help page but feel free to skip this for now. The <code>Control</code> help page gives additional details.</p>
<p>(When you run a help page in this tutorial, it looks a bit funny. Try running <code>?Reserved</code> directly in <code>RStudio</code> for better formatting.)</p></li>
<li><p>A “literal”. This is a word that represents “just the thing” without any additional indirection. The most common types of literals are:</p>
<ul>
<li>Numeric: <em>e.g.</em>, <code>3</code>, <code>42.0</code>, or <code>1e-3</code></li>
<li>String: <em>e.g.</em>, <code>'a'</code>, <code>"beach"</code>, or <code>'cream soda'</code> There are a few rules for literals, but the most important is that strings begin and end with the same character, either a single quote or a double quote. When <code>R</code> sees a single quote, it will read <em>everything</em> until the next single quote as one string, even if there’s a double quote inside.</li>
</ul>
<p>Try some literals:</p></li>
</ul>
<div class="cell">
<pre class="{webr}"><code>42
"a"
"3 + 4"
'if I go to 4 beaches, I will shout "hurray!"'</code></pre>
</div>
<p>What does the literal <code>0xF</code> represent? (You don’t need to worry about why. This is a fancier literal than we will use in this class.) - A “variable name”. This is the most common sort of “word” in code. It is used to <em>something</em> without actually having to know what it is.</p>
<p>We can create variables using the “assignment” operator: <code>&lt;-</code></p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- 3
x</code></pre>
</div>
<p>When you read this outloud, read <code>&lt;-</code> as “gets” so <code>x &lt;- 3</code> becomes “x gets 3.”</p>
<p>When we use the assignment operator on a variable, it overwrites the value of a variable silently and without warning</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- 3
x
x &lt;- 5
x</code></pre>
</div>
<p>We also put expressions on the right hand side of an assignment:</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- 1 + 2
x
y &lt;- sin(pi / 2) ## Radians!
y </code></pre>
</div>
<p>Also note the trick we’ve used here a few times: a “plain” line of code without an assignment generally prints its value.</p>
</section>
<section id="comments" class="level3">
<h3 class="anchored" data-anchor-id="comments">Comments</h3>
<p>When you include a <code>#</code> symbol, <code>R</code> will ignore everything after it. This is called a <em>comment</em> and you can use it to leave notes to yourself about what you are doing and why.</p>
</section>
<section id="vector-data-types" class="level3">
<h3 class="anchored" data-anchor-id="vector-data-types">Vector Data Types</h3>
<p>A <em>vector</em> is a ordered array of the same <em>sort</em> of thing (<em>e.g.</em>, all numbers or all strings). We can create vectors using the <code>c</code> command (short for concatenate).</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- c(1, 2, 3)
x
y &lt;- c("a", "b", "c")
y</code></pre>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Change the above example to <code>c(1, "a", 3)</code> and examine the output. What happened? Why?</p>
</div>
</div>
</div>
<p>To see the <em>type</em> (sort) of a vector, you can use the <code>str</code> command.</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- c(1, 2, 3)
str(x)</code></pre>
</div>
<p><code>str(x)</code> tells us about the <em>structure</em> of <code>x</code>. Here, we see that <code>x</code> is a <em>numeric</em> vector of length 3.</p>
<p><code>R</code> will try to do the right thing when doing arithmetic on vectors.</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- c(1, 2, 3)
x + 5</code></pre>
</div>
<div class="cell">
<pre class="{webr}"><code>x &lt;- c(1, 2, 3)
y &lt;- c(4, 5, 6)
x + y</code></pre>
</div>
<p>When you give <code>R</code> vectors of different lenghts, it will “recycle” the shorter one to the length of the longer one.</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- c(1, 2, 3, 4)
y &lt;- c(10, 20)
x + y</code></pre>
</div>
<p>This can be a double-edge sword when the two vectors don’t fit together so nicely:</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- c(1, 2, 3)
y &lt;- c(4, 5)
x + y</code></pre>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>How was the last element of <code>x+y</code> computed?</p>
</div>
</div>
</div>
<p>Here we see also that <code>R</code> printed a <em>warning</em> message. A <em>warning</em> message is <code>R</code>’s way of saying “something is funny, but I can still do this” while it (successfully) implements your command. It’s here to help you, but sometimes can be safely ignored if you’re sure about what you’re doing.</p>
<p>An <em>error</em> is a “I can’t do this” message. When <code>R</code> encounters an <code>error</code> it stops and does not fully execute the command</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- c(1, 2, 3)
y &lt;- c("a", "b", "c")
x * y</code></pre>
</div>
<p>Here we get an error because there is no meaningful way to multiply a string by a number, unlike earlier where the recycling rule told <code>R</code> what to do, even if it was probably a bad idea.</p>
</section>
</section>
<section id="functions" class="level2">
<h2 class="anchored" data-anchor-id="functions">Functions</h2>
<section id="functions-1" class="level3">
<h3 class="anchored" data-anchor-id="functions-1">Functions</h3>
<p>In many of these exercises, we have used commands that have the form <code>NAME()</code> with zero or more comma-separated elements in the parentheses.</p>
<p>This represents a <em>function</em> call. Specifically, the command <code>func(x, y)</code> calls the function named <code>func</code> with two <em>arguments</em> <code>x</code> and <code>y</code>.</p>
<p>Functions are the <em>verbs</em> of the programming world. They are how anything gets done. So far, we’ve only used some basic functions:</p>
<ul>
<li><code>c</code>: the concatenate function</li>
<li><code>print</code>: the print function</li>
<li><code>str</code>: the structure function</li>
<li><code>list</code>: the list making function</li>
</ul>
<p>But there are tons of other useful ones!</p>
<p>Try these out: - <code>length</code> on a vector - <code>colnames</code> on a data frame (like <code>PlantGrowth</code>) - <code>toupper</code> on a string (vector) - <code>as.character</code> on a numeric value</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- c(1, 2, 3, 4, 5)
length(x)
colnames(PlantGrowth)
y &lt;- c("Baruch", "CUNY", "Zicklin")
toupper(y)
as.character(cos(pi))</code></pre>
</div>
<section id="arguments-positional-and-keyword" class="level4">
<h4 class="anchored" data-anchor-id="arguments-positional-and-keyword">Arguments: Positional and Keyword</h4>
<p>The <em>inputs</em> to a function are called the arguments. They come in two forms: - Positional - Keyword</p>
<p>So far we have only seen positional arguments. The function interprets them in an order that depends on they were given:</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- 3
y &lt;- 5
paste(x, y)
paste(y, x)</code></pre>
</div>
<p>Here <code>paste</code> combines two values into a string. We get different output strings depending on the order of the input.</p>
<p>Other arguments can be passed as <em>keyword</em> arguments. Keyword arguments come with names that tell functions how to interpret them. For example, the <code>paste</code> function has an optional keyword argument <code>sep</code> that controls how the strings are combined.</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- 3
y &lt;- 5
paste(x, y, sep="+")
paste(y, x, sep="&gt;&lt;&gt;&lt;")</code></pre>
</div>
<p>Keyword arguments typically have defaults so you don’t need to always provide them. For the <code>paste</code> function, the <code>sep</code> defaults to <code>" "</code>.</p>
</section>
</section>
<section id="creating-your-own-functions" class="level3">
<h3 class="anchored" data-anchor-id="creating-your-own-functions">Creating Your Own Functions</h3>
<p>When you want to create your own function, you use a variant of the assignment structure</p>
<div class="cell">
<pre class="{webr}"><code>#| eval: true
#| echo: true
my_addition &lt;- function(x, y) {
    x + y
}</code></pre>
</div>
<p>Let’s break this into pieces:</p>
<ul>
<li>On the left hand side of the assignment operator <code>&lt;-</code>, we see the function name. This works exactly the same as vector assignment.</li>
<li>Immediately to the right of the assignment operator, we see the keyword <code>function</code>. This tells <code>R</code> that we are defining a function.</li>
<li>After the word function, we see the “argument list”, <em>i.e.</em>, the list of inputs to the function (comma separated). Here, we are not providing default values for any function.</li>
<li>Finally, between the curly braces, we get the <em>body</em> of the function. This is actually the code defining a function’s behavior. You can do basically anything here! Define variables, do arithmetic, load packages, call other functions - it’s all valid. (In fact, you can even define a function within a function, but that’s sort of advanced.)</li>
<li>The last line of the body (here the only line) defines the <em>return</em> value of the function, <em>i.e.</em>, its output.</li>
</ul>
<p>This function will add two numbers together. Now that we’ve defined it, we can use it just like a built-in function:</p>
<div class="cell">
<pre class="{webr}"><code>my_addition(2, 4)</code></pre>
</div>
<p><strong>Tip</strong>: You can see the code used to define any function by simply printing it: think of the code as being the “value” and the function name as the variable name. (This isn’t actually just a metaphor - it’s literally true!)</p>
<section id="default-arguments" class="level4">
<h4 class="anchored" data-anchor-id="default-arguments">Default Arguments</h4>
<p>Sometimes, we want functions to have <em>default</em> but changeable behvaior. This is <em>default arguments</em> come in. If the user provides a value, the function uses it, but otherwise the default is used.</p>
<p>For example,</p>
<div class="cell">
<pre class="{webr}"><code>make_bigger &lt;- function(x, by=2){
    x + by
}

make_bigger(3)</code></pre>
</div>
<div class="cell">
<pre class="{webr}"><code>make_bigger(3, by = 3)</code></pre>
</div>
<p>Here <code>by</code> defaults to <code>2</code>, but the user is required to supply <code>x</code> because it has no default.</p>
<div class="cell">
<pre class="{webr}"><code>make_bigger(by=3)</code></pre>
</div>
<p>There are lots of details in the mechanics - they even can be ‘dynamic’ using some tricks - but in general, they should “just work.”</p>
</section>
</section>
</section>
<section id="control-flow" class="level2">
<h2 class="anchored" data-anchor-id="control-flow">Control Flow</h2>
<p>So far, all of the code we have written executes <em>linearly</em>, one line at a time. To write complex programs, however, we sometimes need code to execute in other ways: <em>e.g.</em>, going line by line through a complex data set running the same code (a “loop”) or doing different things depending on the value of a variable (a “conditional”). This brings us to the topic of <em>control flow</em>, or how a program gets executed.</p>
<section id="conditionals" class="level3">
<h3 class="anchored" data-anchor-id="conditionals">Conditionals</h3>
<p>Perhaps the most common control flow operator is the “conditional” - the <code>if</code> operator. In <code>R</code>, the <code>if</code> operator looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(TEST){</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Some code goes here</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This gets run if `TEST` is true</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Some code goes here</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This gets run if `TEST` if false</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For example</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- 3
if(x &gt; 0){
    print("x is positive!")
} else {
    print("x is negative")
}</code></pre>
</div>
<p>The element inside the <code>if</code> (the test statement) should ideally be Boolean (TRUE/FALSE-ish) but <code>R</code> will make a reasonable guess if it isn’t.</p>
<p>Note that you can omit the <code>else</code> part and the second set of braces that go with it, but the first set of braces, immediately after <code>if()</code>, should always be there.</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- 2
if(x %% 2){
    print("x is odd!")
}</code></pre>
</div>
<p>Change the value of <code>x</code> and see what happens. Next, modify this by adding an <code>else</code> statement to handle the case of odd numbers.</p>
<p>Note that we’re using the <code>%%</code> operator here. If you haven’t seen it before, recall you can get help by typing</p>
<blockquote class="blockquote">
<p>?<code>%%</code></p>
</blockquote>
<p>in <code>R</code>. In this case, <code>%%</code> is a <code>modulo</code> operator; that is, it is the “remainder” from division. (Do you see how it works here?)</p>
<p>We’ll practice using conditional operators below.</p>
</section>
<section id="looping" class="level3">
<h3 class="anchored" data-anchor-id="looping">Looping</h3>
<p>In other contexts, it is useful to perform the same operation several times over. When possible, it is best to use a vectorized approach, but sometimes that’s not feasible. In particular, if you have a situation where you need a value from the previous time, vectorization isn’t going to work.</p>
<p>In this case, you need a loop. There are several types of loops, but the most common is the <code>for</code> loop, which looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(VARIABLE_NAME <span class="cf">in</span> VECTOR){</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    BODY</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For example, we can use the <code>toupper</code> function and the <code>month.name</code> vector to do this:</p>
<div class="cell">
<pre class="{webr}"><code>for(month in month.name){
    cat("If you capitalize", month, "you get", toupper(month), "\n")
}</code></pre>
</div>
<p>Here, the loop repeats 12 times - once for each element of <code>month.name</code>. As we go through the loop, the value of the variable <code>month</code> changes: it is set to each element of the vector <code>month.name</code> separately. On a single iteration <code>month</code> is a <em>scalar</em> (length-one vector), not a length-12 vector. The “body” of the loop is the code between the curly braces. It is repeated <em>as is</em>, with the only changes coming from the fact that the value of variables are changed.</p>
<p>A common pattern is to want to repeat a block of code without needing to iterate over a vector. In this case, just define an unused iteration variable and iterate over a sequence. <em>E.g.</em>, to compute the first 10 powers of 2:</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- 1
for(i in 1:10){
    x &lt;- 2 * x
    cat("The next power of 2 is", x, "\n")
}</code></pre>
</div>
<p>Note that this example can be computed more effectively using vectorization: do you see how? Note that if you re-assign a variable other than the loop variable, you can use it again on the next time through the loop: so here, we get the old value of <code>x</code> on the right-hand side of <code>x &lt;- 2 * x</code> and we put the new value back into <code>x</code> for later use.</p>
<p>If you try to assign to the loop variable (<code>i</code>), your values are overwritten at the start of the next loop.</p>
<div class="cell">
<pre class="{webr}"><code>x &lt;- 1
for(i in 1:10){
    cat("At the start of the loop i=", i, "\n")
    i &lt;- i * 2
    cat("At the end of the loop i=", i, "\n")
}</code></pre>
</div>
<p>So be careful what you use the loop variable for.</p>
<p>Because it has vectorization, <code>R</code> uses loops much less than other languages, but they still sometimes appear and it’s worth being aware of them.</p>
</section>
</section>
<section id="programming-exercises" class="level2">
<h2 class="anchored" data-anchor-id="programming-exercises">Programming Exercises</h2>
<p>Write <em>functions</em> to perform each of the following tasks.</p>
<ol type="1">
<li><p>Write a function that takes in a vector of numbers, calculates the length and maximum value of the vector, and prints that information to the screen in a formatted way.</p>
<pre><code>&gt; func_1(c(1, 2, 3, 5, 7))
The largest value in that vector of 5 numbers is 7.

&gt; func_1(c(1, 2, 5, 5))
The largest value in that vector of 4 numbers is 5.</code></pre>
<p>To make your output as attractive as possible, you might want to use the <code>cat</code> command instead of the <code>print</code> command.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<pre class="{webr}"><code>func_1 &lt;- function(x){
   n_values  &lt;- length(x)
   max_value &lt;- max(x)

   cat("The largest value in that vector of ", n_values, " numbers is ", 
       max_value, ".\n", sep="")
}</code></pre>
</div>
<p>which behaves as expected:</p>
<div class="cell">
<pre class="{webr}"><code>func_1(c(1, 2, 3, 5, 7))
func_1(c(1, 2, 5, 5))</code></pre>
</div>
</div>
</div>
</div></li>
<li><p>Write a program that tests whether its (integer) outputs are leap years. Recall the leap year rules:</p>
<ul>
<li>A year is a leap year if it is divisible by 4</li>
<li>But it is not a leap year if it is divisible by 100</li>
<li>Unless it is also divisible by 400</li>
</ul>
<p>Your function should behave like this:</p>
<pre><code>&gt; leap_year(2025)
[1] FALSE
&gt; leap_year(2024)
[1] TRUE
&gt; leap_year(2100)
[1] FALSE
&gt; leap_year(2000)
TRUE</code></pre>
<p>Remember our discussion of the <code>%%</code> operator from above.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<pre class="{webr}"><code>leap_year &lt;- function(yyyy){
   if((yyyy %% 400) == 0){
       TRUE
   } else if((yyyy %% 100) == 0){
       FALSE
   } else if((yyyy %% 4) == 0){
       TRUE
   } else {
       FALSE
   }
}</code></pre>
</div>
<p>Alternatively, we could use a helper function:</p>
<div class="cell">
<pre class="{webr}"><code>divides &lt;- function(n, by){
   if((n %% by) == 0) TRUE else FALSE
}

leap_year &lt;- function(yyyy){
  if(divides(yyyy, 400)){
      TRUE
  } else if(divides(yyyy, 100)){
      FALSE
  } else if(divides(yyyy, 4)){  
      TRUE
  } else {
      FALSE
  }
}</code></pre>
</div>
<p>which behaves as we expect</p>
<div class="cell">
<pre class="{webr}"><code>leap_year(2025)
leap_year(2024)
leap_year(2100)
leap_year(2000)</code></pre>
</div>
</div>
</div>
</div></li>
<li><p>Write a function to greet your classmates with varying levels of enthusiasm. It should have three optional arguments:</p>
<ol type="a">
<li><code>name</code>. The name of the person to greet. Default <code>"friend"</code></li>
<li><code>times</code>. The number of times to repeat the greeting. Default <code>1</code></li>
<li><code>emphasis</code>. A Boolean (TRUE/FALSE) value indicating whether the greeting should end with an exclamaition point. (Default <code>FALSE</code>)</li>
</ol>
<pre><code>&gt; greetings()
Hello, friend
&gt; greetings(name="Michael")
Hello, Michael
&gt; greetings(times=2)
Hello, friend
Hello, friend
&gt; greetings(emphasis=TRUE)
Hello, friend!
&gt; greetings("Michael", 5, TRUE)
Hello, Michael!
Hello, Michael!
Hello, Michael!
Hello, Michael!
Hello, Michael!</code></pre>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<pre class="{webr}"><code>greetings &lt;- function(name = "friend", times=1, emphasis = FALSE){
   if(emphasis){
       string &lt;- paste0("Greetings, ", name, "!")
   } else {
       string &lt;- paste0("Greetings, ", name)
   }

   for(n in seq(times)){
       cat(string, "\n")
   }
   cat("\n")
}</code></pre>
</div>
<p>which gives</p>
<div class="cell">
<pre class="{webr}"><code>greetings()
greetings(name="Michael")
greetings(times=2)
greetings(emphasis=TRUE)
greetings("Michael", 5, TRUE)</code></pre>
</div>
</div>
</div>
</div></li>
<li><p>The <a href="https://en.wikipedia.org/wiki/Riemann_zeta_function">Riemann Zeta Function</a> is a famous function in analytic number theory<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> defined as</p>
<p><span class="math display">\[\zeta(k) = 1 + \left(\frac{1}{2}\right)^k + \left(\frac{1}{3}\right)^k + \dots = \sum_{i=1}^{\infty} i^{-k} \]</span> We cannot implement an infinite series in <code>R</code>, but we can get very close by taking a large number of terms in the series (<em>e.g</em>, the first 500,000). Implement the zeta function and show that <span class="math inline">\(\zeta(2) = \frac{\pi^2}{6}\)</span></p>
<pre><code>&gt; zeta(2)
[1] 1.644932
&gt; zeta(3)
[1] 1.202057
&gt; zeta(4)
[1] 1.082323
&gt; all.equal(zeta(2), pi^2/6, tol=1e-4)
[1] TRUE</code></pre>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<pre class="{webr}"><code>zeta &lt;- function(x){
    sum((1/(1:500000))^x)
}</code></pre>
</div>
<p>which gives</p>
<div class="cell">
<pre class="{webr}"><code>zeta(2)
zeta(3)
zeta(4)
all.equal(zeta(2), pi^2/6, tol=1e-4)</code></pre>
</div>
</div>
</div>
</div></li>
<li><p><em>Hero of Alexandria</em> developed a method for computing square roots numerically. He showed that by performing the following update repeatedly, <span class="math inline">\(x\)</span> will converge to <span class="math inline">\(\sqrt{n}\)</span>:</p>
<p><span class="math display">\[x \leftarrow \frac{1}{2}\left(x + \frac{n}{x}\right)\]</span> You can start with any positive <span class="math inline">\(x\)</span>, but <span class="math inline">\(n/2\)</span> is a good choice.</p>
<p>Implement this method to compute square roots. Use an optional keyword argument <code>iter</code> with a default value of 100 to control how many iterations are performed:</p>
<pre><code>&gt; hero_sqrt(100)
[1] 1.644932
&gt; hero_sqrt(3)^2
[1] 3
&gt; hero_sqrt(3, iter=2)
[1] 1.732143
&gt; hero_sqrt(3000)
[1] 54.77226</code></pre>
<div class="callout callout-style-default callout-note callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<pre class="{webr}"><code>hero_sqrt &lt;- function(n, iter=100){
    x &lt;- n/2
    for(i in 1:iter){
        x &lt;- 0.5 * (x + n/x)
    }
    x
}</code></pre>
</div>
<p>which gives</p>
<div class="cell">
<pre class="{webr}"><code>hero_sqrt(100)
hero_sqrt(3)^2
hero_sqrt(3, iter=2)
hero_sqrt(3000)</code></pre>
</div>
</div>
</div>
</div></li>
</ol>
</section>
<section id="executing-code-in-r" class="level2">
<h2 class="anchored" data-anchor-id="executing-code-in-r">Executing Code in <code>R</code></h2>
<p>Now that you’re executing <code>R</code> code, it’s worth taking a moment and walking through some of the details of <em>how</em> <code>R</code> and <code>RStudio</code> go about executing code. There are quite a few details here – and not all of them will make complete sense at first – so bookmark this session and come back to it as needed. If something is still confusing, contact the instructor and I’ll provide some more details.</p>
<p>In particular, save this section and refer back to it when you start <a href="../../STA9750/miniprojects/mini01.html">Mini-Project #01</a>, as that will be the first time you need to write a large amount of <code>R</code> code in a <code>qmd</code> document over several sessions.</p>
<p>All <code>R</code> code gets executed in a “session” - you can think of this as a ‘place’ or ‘environment’ where computations are performed, variables get stored, packages loaded, <em>etc.</em> Sessions are isolated, so whatever happens in session A has no effect on session B or <em>vice versa</em>. In particular, if you create a variable in Session A, but then try to use it in Session B, you will get an “object not found” error since Session B can’t see what you did in Session A. There are really only two ways to do things in <code>R</code> that translate across sessions - and that’s because they involve saving files to your computer that can be accessed by the other session:</p>
<ol type="1">
<li>Installing packages. Just like you don’t have to <code>install.packages</code> a package more than once over time, you also don’t need to install it in multiple sessions. All <code>R</code> packages live in a globally accessible directory, so all <code>R</code> sessions can see all installed packages by default.</li>
<li>Saving data files. If you save a data file, like a <code>csv</code> in one <code>R</code> session, you can read that <code>csv</code> into a different <code>R</code> session. There’s really nothing special about the fact both the ‘reader’ and ‘writer’ are <code>R</code> sessions here. In general, files saved by one program can be accessed by another program on the same computer. That fact that our reader and writer are both <code>R</code> sessions just gives us a better chance of avoiding file-type compatability issues.</li>
</ol>
<p>So - except for those two “global” actions - whenever you run code, it’s important to distinguish <em>which session</em> is being used to run your code.</p>
<p><em>Anything</em> that gets executed in the <code>Console</code> in <code>RStudio</code> runs in the same session, unless you specifically restart <code>RStudio</code> or otherwise create a new session. (This normally only happens when things go wrong and <code>RStudio</code> has to abort your current session to avoid even worse problems.) Code can be executed in the <code>Console</code> session in several different ways:</p>
<ul>
<li><p>You can type something directly into the Console. This is the simplest model, but unless you are a perfect typist, this doesn’t really scale to larger or more complex commands.</p></li>
<li><p>You can type something in a <code>.R</code> file, <em>i.e.</em>, an “R Script” and then run it in the console by either i) highlighting and <code>Run</code>ning relevant lines; or by ii) or <code>Source</code>ing the entire <code>.R</code> file. Either way, when you do this, you will see that the code is copied into the <code>Console</code> automatically and executed there.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p></li>
<li><p>You can execute one-or-more code blocks from a <code>Quarto</code> (<code>.qmd</code>) document in the <code>Console</code> session. This happens whenever you press the little green “Run Current Chunk” arrow buttons to the top-right of a code chunk<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> or if you use the <code>Run</code> button near the top of the Window to run one or more chunks</p></li>
</ul>
<p>So, wherever you happen to type the code - it gets run in the same session if it is run in any of these three ways.</p>
<p>So why is it worth talking about sessions at all if it all code to the same place to be executed? It turns out there’s one exception - but it’s a very important one.</p>
<p>When you hit the <code>Render</code> button for a <code>.qmd</code> document (or hit the <code>Save</code> button if you have <code>Render-on-Save</code> enabled), all of the code chunks in that document – and only the code chunks in that document – get run in a <em>brand-new session</em>. In particular, you get a new session every time you hit <code>Render</code>, so hitting <code>Render</code> twice will execute your code twice in two different (and not connected) sessions.</p>
<p>Because you’re starting from a clean state at every render, it is important that <em>all of the code you need exists</em> in a code chunk in the <code>.qmd</code> file. If you only define a variable in the <code>Console</code> session and not in a code chunk in your <code>.qmd</code> file, but try to reference that variable within the <code>.qmd</code> <code>Render</code>ing process, you will get a “object not found” error. This is because the <code>Render</code>-session can’t ‘see’ what you’ve done anywhere else:<br>
the <code>Render</code>-session does not have access to whatever you’ve done in the <code>Console</code> session. In particular, if you run the same code chunk once in the <code>Console</code> session using a <code>Run</code> button and later in a <code>Render</code>-induced different session, the two executions will be totally isolated, even though it is the same code.</p>
<p>So why is this second session worth it? Why does <code>quarto</code> insist on doing things in a new session instead of giving us maximum flexibility to write and run our code wherever is most convenient? The use of a ‘clean-room’ session guarantees <em>reproducibility</em> and <em>self-containedness</em>. If the <code>.qmd</code> <code>Render</code>ing uses <em>all of the code</em> in the <code>.qmd</code> document and only the code in the <code>.qmd</code> document, then the <code>.qmd</code> document must be a perfect record of those calculations.</p>
<p>If you do something directly in the <code>Console</code>, but never save the code, then there’s no guarantee that the code you have in your document actually matches the output that gets printed. Even worse, the code that only exists in the <code>Console</code> may be lost if it is not recorded elsewhere in a <code>.qmd</code> or similar document.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Recommend Quarto Workflow">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Recommend Quarto Workflow
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When writing code in a Quarto document, I tend to work in parallel tracks. As I’m figuring out what I want to do, I try a bunch of different things in the <code>Console</code> session, either writing them directly or, more commonly, in a <code>.R</code> script that gets executed in the same session. Then, once I’ve settled on code that does what I want – or at least seems to do what I want – I copy it into a new chunk in my <code>.qmd</code> document. As I work through the project, my <code>.qmd</code> document contains only my “good code” and the scraps of my earlier attemps are lost in the aether.</p>
<p>I also regularly re-<code>Render</code> the <code>.qmd</code> file to ensure that it has everything it needs to execute properly. If I forgot to put some necessary code into a <code>.qmd</code> code block, I will get an error when I move on to the next code block that depends on the missing code block. I try to <code>Render</code> about as often as possible: this makes debugging easier. In particular, if I re-<code>Render</code> any time I add or edit a code chunk and I observe an error, I know that it is coming from the chunk I just worked on. Finding the error may still take a bit of effort, but it’s far simpler than finding it in the entire document without any context.</p>
<p>In particular, I <em>don’t write code directly in my <code>.qmd</code> document</em> and I <em>don’t use the <code>Run</code> button or the little <code>Run</code> arrows</em> to run <code>.qmd</code> code chunks in the <code>Console</code> session. I find it easier to think of <code>Console</code>-land and <code>Render</code>-land as two distinct “places” and avoid mixing them. <code>R</code> won’t get them crossed, but I do everytime I break this separation, so I do my best to avoid going down that path. It takes a bit more copy and paste work, but it’s worth it as it makes the mental bookkeeping easier.</p>
<p>There is one rough edge to this workflow. When you <code>Render</code> a <code>.qmd</code> file - and all code is executed in a new session - but an error is encountered it can sometimes be a bit hard to figure out the root cause of the error. In particular, <code>quarto</code> will print out the text of the error in the <code>Background Jobs</code> tab, but there’s no way to ‘pause’ mid-<code>Render</code> and take a look around. Quarto tries to help a little by giving line numbers identifying the chunk where the error occurred but that’s only a ‘symptom’ the actual cause may be much earlier. <em>E.g.</em>, if I define a variable in Chunk 1 but misspell its name, and then I wait to use that variable until Chunk 50 where I spell the name correctly, I will get a <code>object not found</code> error in Chunk 50, not Chunk 1.</p>
<p>As noted above, frequent re-<code>Render</code>ing certainly makes it easier - though not 100% painless - to find the source of an error. Because <code>Render</code>ing takes place in a separate session, specifically in a <code>Background Job</code>, I can set a long document to render while I continue to write new code and only need to interrupt my flow if an error is encountered in the background <code>Render</code> process.</p>
</div>
</div>
</div>
<p>Wrapping up, it doesn’t matter where you <em>write</em> the code: it matters where it gets <em>executed</em>, <em>i.e.</em>, in which session. Sessions are interchangeable with tabs in RStudio: the primary session you’ll use for writing and trying out code is associated with the <code>Console</code> tab. I use this session to keep iterating on code until I’m happy with it.</p>
<p>The other session is associated with the <code>Render</code> button of a <code>.qmd</code> file and with the <code>Background Jobs</code> tab. <code>Quarto</code> uses this to run all the code in a <code>.qmd</code>file in a “clean room” as part of rendering a document. I only put my ‘finished’ code in a <code>.qmd</code> file code block. I <code>Render</code> regularly to make sure that those code blocks are working as expected.</p>
<p>Finally, and hopefully this goes without saying, all the interactive blocks on this page are a totally different session than anything you do through <code>RStudio</code>. But all blocks on this page share the same session, which lasts until you refresh or exit the page. This is why we could define a function in one chunk of the Exercises and test it in the next chunk - they are both executed in the same session and have the same access to our functions (once defined).</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The <code>BioConductor</code> project produces over 2000 high-quality non-CRAN packages for bioinformatics alone.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>ANL is basically the application of calculus techniques to prove properties of prime numbers: it’s a surprisingly powerful approach.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Sometimes the settings on <code>Source</code> button will be set to run your code, printing only the output and suppressing the input. I find this behavior a bit confusing - I want to see the code that was executed! - so I tend to disable it. If editing a <code>.R</code> file, click the tiny-little down arrow button next to the <code>Source</code> button and select <code>Source with Echo</code> to ensure the code is printed before execution.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>If you are of a certain age, they look like an old-school VCR right arrow / play button.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/Ghirschhorn\.github\.io\/STA9750-2025-FALL\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>